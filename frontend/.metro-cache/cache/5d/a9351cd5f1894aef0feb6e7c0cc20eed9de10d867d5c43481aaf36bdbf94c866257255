{"dependencies":[{"name":"expo-file-system/legacy","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":54,"index":54}}],"key":"hYqFhoW7zWgYTBVE1SkA0/XFH/Y=","exportNames":["*"],"imports":1}},{"name":"expo-sharing","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":55},"end":{"line":2,"column":40,"index":95}}],"key":"SUh687CeWkW0B+T6RbmrU/yQMvg=","exportNames":["*"],"imports":1}},{"name":"jszip","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":96},"end":{"line":3,"column":26,"index":122}}],"key":"SegeJSmff7NIIt8dZceHuwVvNVg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"exportProjectToZip\", {\n    enumerable: true,\n    get: function () {\n      return exportProjectToZip;\n    }\n  });\n  var _expoFileSystemLegacy = require(_dependencyMap[0], \"expo-file-system/legacy\");\n  var FileSystem = _interopNamespace(_expoFileSystemLegacy);\n  var _expoSharing = require(_dependencyMap[1], \"expo-sharing\");\n  var Sharing = _interopNamespace(_expoSharing);\n  var _jszip = require(_dependencyMap[2], \"jszip\");\n  var JSZip = _interopDefault(_jszip);\n  const exportProjectToZip = async project => {\n    try {\n      console.log('Starting export for project:', project.projectName);\n      const zip = new JSZip.default();\n\n      // Read all files from the project folder\n      const folderPath = project.folderPath;\n      console.log('Reading from folder:', folderPath);\n\n      // Check if folder exists\n      const folderInfo = await FileSystem.getInfoAsync(folderPath);\n      if (!folderInfo.exists) {\n        return {\n          success: false,\n          error: 'Project folder not found'\n        };\n      }\n\n      // Read directory contents\n      const files = await FileSystem.readDirectoryAsync(folderPath);\n      console.log('Files in folder:', files);\n      for (const fileName of files) {\n        const filePath = `${folderPath}${fileName}`;\n        try {\n          // Check if it's a binary file (audio)\n          if (fileName.endsWith('.mp3') || fileName.endsWith('.wav') || fileName.endsWith('.ogg') || fileName.endsWith('.m4a') || fileName.endsWith('.aac')) {\n            const content = await FileSystem.readAsStringAsync(filePath, {\n              encoding: FileSystem.EncodingType.Base64\n            });\n            zip.file(fileName, content, {\n              base64: true\n            });\n            console.log('Added binary file:', fileName);\n          } else {\n            const content = await FileSystem.readAsStringAsync(filePath, {\n              encoding: FileSystem.EncodingType.UTF8\n            });\n            zip.file(fileName, content);\n            console.log('Added text file:', fileName);\n          }\n        } catch (fileError) {\n          console.error('Error reading file:', fileName, fileError);\n        }\n      }\n\n      // Generate ZIP\n      console.log('Generating ZIP...');\n      const zipBase64 = await zip.generateAsync({\n        type: 'base64'\n      });\n\n      // Create filename\n      const safeProjectName = project.projectName.replace(/[^a-zA-Z0-9_-]/g, '_');\n      const targetLangCode = project.targetLanguage === 'Swiss German' ? 'chde' : project.targetLanguage === 'German' ? 'de' : project.targetLanguage.toLowerCase().substring(0, 2);\n      const nativeLangCode = project.nativeLanguage === 'English' ? 'en' : project.nativeLanguage.toLowerCase().substring(0, 2);\n      const zipFileName = `${targetLangCode}-${nativeLangCode}-${safeProjectName}.zip`;\n\n      // Save ZIP to cache directory\n      const zipPath = `${FileSystem.cacheDirectory}${zipFileName}`;\n      await FileSystem.writeAsStringAsync(zipPath, zipBase64, {\n        encoding: FileSystem.EncodingType.Base64\n      });\n      console.log('ZIP saved to:', zipPath);\n\n      // Share the file\n      const canShare = await Sharing.isAvailableAsync();\n      if (canShare) {\n        await Sharing.shareAsync(zipPath, {\n          mimeType: 'application/zip',\n          dialogTitle: `Share ${project.projectName}`\n        });\n        console.log('Sharing dialog opened');\n\n        // Clean up after sharing\n        setTimeout(async () => {\n          try {\n            await FileSystem.deleteAsync(zipPath, {\n              idempotent: true\n            });\n          } catch (e) {\n            // Ignore cleanup errors\n          }\n        }, 5000);\n        return {\n          success: true\n        };\n      } else {\n        return {\n          success: false,\n          error: 'Sharing is not available on this device'\n        };\n      }\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      console.error('Error exporting project:', errorMessage, error);\n      return {\n        success: false,\n        error: `Export failed: ${errorMessage}`\n      };\n    }\n  };\n});","lineCount":140,"map":[[27,2,6,0,"Object"],[27,8,6,0],[27,9,6,0,"defineProperty"],[27,23,6,0],[27,24,6,0,"exports"],[27,31,6,0],[28,4,6,0,"enumerable"],[28,14,6,0],[29,4,6,0,"get"],[29,7,6,0],[29,18,6,0,"get"],[29,19,6,0],[30,6,6,0],[30,13,6,0,"exportProjectToZip"],[30,31,6,0],[31,4,6,0],[32,2,6,0],[33,2,1,0],[33,6,1,0,"_expoFileSystemLegacy"],[33,27,1,0],[33,30,1,0,"require"],[33,37,1,0],[33,38,1,0,"_dependencyMap"],[33,52,1,0],[34,2,1,0],[34,6,1,0,"FileSystem"],[34,16,1,0],[34,19,1,0,"_interopNamespace"],[34,36,1,0],[34,37,1,0,"_expoFileSystemLegacy"],[34,58,1,0],[35,2,2,0],[35,6,2,0,"_expoSharing"],[35,18,2,0],[35,21,2,0,"require"],[35,28,2,0],[35,29,2,0,"_dependencyMap"],[35,43,2,0],[36,2,2,0],[36,6,2,0,"Sharing"],[36,13,2,0],[36,16,2,0,"_interopNamespace"],[36,33,2,0],[36,34,2,0,"_expoSharing"],[36,46,2,0],[37,2,3,0],[37,6,3,0,"_jszip"],[37,12,3,0],[37,15,3,0,"require"],[37,22,3,0],[37,23,3,0,"_dependencyMap"],[37,37,3,0],[38,2,3,0],[38,6,3,0,"JSZip"],[38,11,3,0],[38,14,3,0,"_interopDefault"],[38,29,3,0],[38,30,3,0,"_jszip"],[38,36,3,0],[39,2,6,7],[39,8,6,13,"exportProjectToZip"],[39,26,6,31],[39,29,6,34],[39,35,6,41,"project"],[39,42,6,57],[39,46,6,109],[40,4,7,2],[40,8,7,6],[41,6,8,4,"console"],[41,13,8,11],[41,14,8,12,"log"],[41,17,8,15],[41,18,8,16],[41,48,8,46],[41,50,8,48,"project"],[41,57,8,55],[41,58,8,56,"projectName"],[41,69,8,67],[41,70,8,68],[42,6,10,4],[42,12,10,10,"zip"],[42,15,10,13],[42,18,10,16],[42,22,10,20,"JSZip"],[42,27,10,25],[42,28,10,25,"default"],[42,35,10,25],[42,36,10,26],[42,37,10,27],[44,6,12,4],[45,6,13,4],[45,12,13,10,"folderPath"],[45,22,13,20],[45,25,13,23,"project"],[45,32,13,30],[45,33,13,31,"folderPath"],[45,43,13,41],[46,6,14,4,"console"],[46,13,14,11],[46,14,14,12,"log"],[46,17,14,15],[46,18,14,16],[46,40,14,38],[46,42,14,40,"folderPath"],[46,52,14,50],[46,53,14,51],[48,6,16,4],[49,6,17,4],[49,12,17,10,"folderInfo"],[49,22,17,20],[49,25,17,23],[49,31,17,29,"FileSystem"],[49,41,17,39],[49,42,17,40,"getInfoAsync"],[49,54,17,52],[49,55,17,53,"folderPath"],[49,65,17,63],[49,66,17,64],[50,6,18,4],[50,10,18,8],[50,11,18,9,"folderInfo"],[50,21,18,19],[50,22,18,20,"exists"],[50,28,18,26],[50,30,18,28],[51,8,19,6],[51,15,19,13],[52,10,19,15,"success"],[52,17,19,22],[52,19,19,24],[52,24,19,29],[53,10,19,31,"error"],[53,15,19,36],[53,17,19,38],[54,8,19,65],[54,9,19,66],[55,6,20,4],[57,6,22,4],[58,6,23,4],[58,12,23,10,"files"],[58,17,23,15],[58,20,23,18],[58,26,23,24,"FileSystem"],[58,36,23,34],[58,37,23,35,"readDirectoryAsync"],[58,55,23,53],[58,56,23,54,"folderPath"],[58,66,23,64],[58,67,23,65],[59,6,24,4,"console"],[59,13,24,11],[59,14,24,12,"log"],[59,17,24,15],[59,18,24,16],[59,36,24,34],[59,38,24,36,"files"],[59,43,24,41],[59,44,24,42],[60,6,26,4],[60,11,26,9],[60,17,26,15,"fileName"],[60,25,26,23],[60,29,26,27,"files"],[60,34,26,32],[60,36,26,34],[61,8,27,6],[61,14,27,12,"filePath"],[61,22,27,20],[61,25,27,23],[61,28,27,26,"folderPath"],[61,38,27,36],[61,41,27,39,"fileName"],[61,49,27,47],[61,51,27,49],[62,8,29,6],[62,12,29,10],[63,10,30,8],[64,10,31,8],[64,14,31,12,"fileName"],[64,22,31,20],[64,23,31,21,"endsWith"],[64,31,31,29],[64,32,31,30],[64,38,31,36],[64,39,31,37],[64,43,31,41,"fileName"],[64,51,31,49],[64,52,31,50,"endsWith"],[64,60,31,58],[64,61,31,59],[64,67,31,65],[64,68,31,66],[64,72,31,70,"fileName"],[64,80,31,78],[64,81,31,79,"endsWith"],[64,89,31,87],[64,90,31,88],[64,96,31,94],[64,97,31,95],[64,101,32,12,"fileName"],[64,109,32,20],[64,110,32,21,"endsWith"],[64,118,32,29],[64,119,32,30],[64,125,32,36],[64,126,32,37],[64,130,32,41,"fileName"],[64,138,32,49],[64,139,32,50,"endsWith"],[64,147,32,58],[64,148,32,59],[64,154,32,65],[64,155,32,66],[64,157,32,68],[65,12,33,10],[65,18,33,16,"content"],[65,25,33,23],[65,28,33,26],[65,34,33,32,"FileSystem"],[65,44,33,42],[65,45,33,43,"readAsStringAsync"],[65,62,33,60],[65,63,33,61,"filePath"],[65,71,33,69],[65,73,33,71],[66,14,34,12,"encoding"],[66,22,34,20],[66,24,34,22,"FileSystem"],[66,34,34,32],[66,35,34,33,"EncodingType"],[66,47,34,45],[66,48,34,46,"Base64"],[67,12,35,10],[67,13,35,11],[67,14,35,12],[68,12,36,10,"zip"],[68,15,36,13],[68,16,36,14,"file"],[68,20,36,18],[68,21,36,19,"fileName"],[68,29,36,27],[68,31,36,29,"content"],[68,38,36,36],[68,40,36,38],[69,14,36,40,"base64"],[69,20,36,46],[69,22,36,48],[70,12,36,53],[70,13,36,54],[70,14,36,55],[71,12,37,10,"console"],[71,19,37,17],[71,20,37,18,"log"],[71,23,37,21],[71,24,37,22],[71,44,37,42],[71,46,37,44,"fileName"],[71,54,37,52],[71,55,37,53],[72,10,38,8],[72,11,38,9],[72,17,38,15],[73,12,39,10],[73,18,39,16,"content"],[73,25,39,23],[73,28,39,26],[73,34,39,32,"FileSystem"],[73,44,39,42],[73,45,39,43,"readAsStringAsync"],[73,62,39,60],[73,63,39,61,"filePath"],[73,71,39,69],[73,73,39,71],[74,14,40,12,"encoding"],[74,22,40,20],[74,24,40,22,"FileSystem"],[74,34,40,32],[74,35,40,33,"EncodingType"],[74,47,40,45],[74,48,40,46,"UTF8"],[75,12,41,10],[75,13,41,11],[75,14,41,12],[76,12,42,10,"zip"],[76,15,42,13],[76,16,42,14,"file"],[76,20,42,18],[76,21,42,19,"fileName"],[76,29,42,27],[76,31,42,29,"content"],[76,38,42,36],[76,39,42,37],[77,12,43,10,"console"],[77,19,43,17],[77,20,43,18,"log"],[77,23,43,21],[77,24,43,22],[77,42,43,40],[77,44,43,42,"fileName"],[77,52,43,50],[77,53,43,51],[78,10,44,8],[79,8,45,6],[79,9,45,7],[79,10,45,8],[79,17,45,15,"fileError"],[79,26,45,24],[79,28,45,26],[80,10,46,8,"console"],[80,17,46,15],[80,18,46,16,"error"],[80,23,46,21],[80,24,46,22],[80,45,46,43],[80,47,46,45,"fileName"],[80,55,46,53],[80,57,46,55,"fileError"],[80,66,46,64],[80,67,46,65],[81,8,47,6],[82,6,48,4],[84,6,50,4],[85,6,51,4,"console"],[85,13,51,11],[85,14,51,12,"log"],[85,17,51,15],[85,18,51,16],[85,37,51,35],[85,38,51,36],[86,6,52,4],[86,12,52,10,"zipBase64"],[86,21,52,19],[86,24,52,22],[86,30,52,28,"zip"],[86,33,52,31],[86,34,52,32,"generateAsync"],[86,47,52,45],[86,48,52,46],[87,8,52,48,"type"],[87,12,52,52],[87,14,52,54],[88,6,52,63],[88,7,52,64],[88,8,52,65],[90,6,54,4],[91,6,55,4],[91,12,55,10,"safeProjectName"],[91,27,55,25],[91,30,55,28,"project"],[91,37,55,35],[91,38,55,36,"projectName"],[91,49,55,47],[91,50,55,48,"replace"],[91,57,55,55],[91,58,55,56],[91,75,55,73],[91,77,55,75],[91,80,55,78],[91,81,55,79],[92,6,56,4],[92,12,56,10,"targetLangCode"],[92,26,56,24],[92,29,56,27,"project"],[92,36,56,34],[92,37,56,35,"targetLanguage"],[92,51,56,49],[92,56,56,54],[92,70,56,68],[92,73,56,71],[92,79,56,77],[92,82,57,26,"project"],[92,89,57,33],[92,90,57,34,"targetLanguage"],[92,104,57,48],[92,109,57,53],[92,117,57,61],[92,120,57,64],[92,124,57,68],[92,127,58,26,"project"],[92,134,58,33],[92,135,58,34,"targetLanguage"],[92,149,58,48],[92,150,58,49,"toLowerCase"],[92,161,58,60],[92,162,58,61],[92,163,58,62],[92,164,58,63,"substring"],[92,173,58,72],[92,174,58,73],[92,175,58,74],[92,177,58,76],[92,178,58,77],[92,179,58,78],[93,6,59,4],[93,12,59,10,"nativeLangCode"],[93,26,59,24],[93,29,59,27,"project"],[93,36,59,34],[93,37,59,35,"nativeLanguage"],[93,51,59,49],[93,56,59,54],[93,65,59,63],[93,68,59,66],[93,72,59,70],[93,75,60,26,"project"],[93,82,60,33],[93,83,60,34,"nativeLanguage"],[93,97,60,48],[93,98,60,49,"toLowerCase"],[93,109,60,60],[93,110,60,61],[93,111,60,62],[93,112,60,63,"substring"],[93,121,60,72],[93,122,60,73],[93,123,60,74],[93,125,60,76],[93,126,60,77],[93,127,60,78],[94,6,61,4],[94,12,61,10,"zipFileName"],[94,23,61,21],[94,26,61,24],[94,29,61,27,"targetLangCode"],[94,43,61,41],[94,47,61,45,"nativeLangCode"],[94,61,61,59],[94,65,61,63,"safeProjectName"],[94,80,61,78],[94,86,61,84],[96,6,63,4],[97,6,64,4],[97,12,64,10,"zipPath"],[97,19,64,17],[97,22,64,20],[97,25,64,23,"FileSystem"],[97,35,64,33],[97,36,64,34,"cacheDirectory"],[97,50,64,48],[97,53,64,51,"zipFileName"],[97,64,64,62],[97,66,64,64],[98,6,65,4],[98,12,65,10,"FileSystem"],[98,22,65,20],[98,23,65,21,"writeAsStringAsync"],[98,41,65,39],[98,42,65,40,"zipPath"],[98,49,65,47],[98,51,65,49,"zipBase64"],[98,60,65,58],[98,62,65,60],[99,8,66,6,"encoding"],[99,16,66,14],[99,18,66,16,"FileSystem"],[99,28,66,26],[99,29,66,27,"EncodingType"],[99,41,66,39],[99,42,66,40,"Base64"],[100,6,67,4],[100,7,67,5],[100,8,67,6],[101,6,68,4,"console"],[101,13,68,11],[101,14,68,12,"log"],[101,17,68,15],[101,18,68,16],[101,33,68,31],[101,35,68,33,"zipPath"],[101,42,68,40],[101,43,68,41],[103,6,70,4],[104,6,71,4],[104,12,71,10,"canShare"],[104,20,71,18],[104,23,71,21],[104,29,71,27,"Sharing"],[104,36,71,34],[104,37,71,35,"isAvailableAsync"],[104,53,71,51],[104,54,71,52],[104,55,71,53],[105,6,72,4],[105,10,72,8,"canShare"],[105,18,72,16],[105,20,72,18],[106,8,73,6],[106,14,73,12,"Sharing"],[106,21,73,19],[106,22,73,20,"shareAsync"],[106,32,73,30],[106,33,73,31,"zipPath"],[106,40,73,38],[106,42,73,40],[107,10,74,8,"mimeType"],[107,18,74,16],[107,20,74,18],[107,37,74,35],[108,10,75,8,"dialogTitle"],[108,21,75,19],[108,23,75,21],[108,32,75,30,"project"],[108,39,75,37],[108,40,75,38,"projectName"],[108,51,75,49],[109,8,76,6],[109,9,76,7],[109,10,76,8],[110,8,77,6,"console"],[110,15,77,13],[110,16,77,14,"log"],[110,19,77,17],[110,20,77,18],[110,43,77,41],[110,44,77,42],[112,8,79,6],[113,8,80,6,"setTimeout"],[113,18,80,16],[113,19,80,17],[113,31,80,29],[114,10,81,8],[114,14,81,12],[115,12,82,10],[115,18,82,16,"FileSystem"],[115,28,82,26],[115,29,82,27,"deleteAsync"],[115,40,82,38],[115,41,82,39,"zipPath"],[115,48,82,46],[115,50,82,48],[116,14,82,50,"idempotent"],[116,24,82,60],[116,26,82,62],[117,12,82,67],[117,13,82,68],[117,14,82,69],[118,10,83,8],[118,11,83,9],[118,12,83,10],[118,19,83,17,"e"],[118,20,83,18],[118,22,83,20],[119,12,84,10],[120,10,84,10],[121,8,86,6],[121,9,86,7],[121,11,86,9],[121,15,86,13],[121,16,86,14],[122,8,88,6],[122,15,88,13],[123,10,88,15,"success"],[123,17,88,22],[123,19,88,24],[124,8,88,29],[124,9,88,30],[125,6,89,4],[125,7,89,5],[125,13,89,11],[126,8,90,6],[126,15,90,13],[127,10,90,15,"success"],[127,17,90,22],[127,19,90,24],[127,24,90,29],[128,10,90,31,"error"],[128,15,90,36],[128,17,90,38],[129,8,90,80],[129,9,90,81],[130,6,91,4],[131,4,92,2],[131,5,92,3],[131,6,92,4],[131,13,92,11,"error"],[131,18,92,16],[131,20,92,18],[132,6,93,4],[132,12,93,10,"errorMessage"],[132,24,93,22],[132,27,93,25,"error"],[132,32,93,30],[132,44,93,42,"Error"],[132,49,93,47],[132,52,93,50,"error"],[132,57,93,55],[132,58,93,56,"message"],[132,65,93,63],[132,68,93,66],[132,83,93,81],[133,6,94,4,"console"],[133,13,94,11],[133,14,94,12,"error"],[133,19,94,17],[133,20,94,18],[133,46,94,44],[133,48,94,46,"errorMessage"],[133,60,94,58],[133,62,94,60,"error"],[133,67,94,65],[133,68,94,66],[134,6,95,4],[134,13,95,11],[135,8,95,13,"success"],[135,15,95,20],[135,17,95,22],[135,22,95,27],[136,8,95,29,"error"],[136,13,95,34],[136,15,95,36],[136,33,95,54,"errorMessage"],[136,45,95,66],[137,6,95,69],[137,7,95,70],[138,4,96,2],[139,2,97,0],[139,3,97,1],[140,0,97,2],[140,3]],"functionMap":{"names":["<global>","exportProjectToZip","setTimeout$argument_0"],"mappings":"AAA;kCCK;iBC0E;ODM;CDW"},"hasCjsExports":false},"type":"js/module"}]}