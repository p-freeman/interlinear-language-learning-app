{"dependencies":[{"name":"../compressions","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":19,"index":34},"end":{"line":3,"column":45,"index":60}}],"key":"GWIJcRIYGYWnWEqmkF3TLA259qg=","exportNames":["*"],"imports":1}},{"name":"./ZipFileWorker","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":20,"index":82},"end":{"line":4,"column":46,"index":108}}],"key":"Wrea8zHWES2GdSxLMHtBq2Qy0as=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var compressions = require(_dependencyMap[0], \"../compressions\");\n  var ZipFileWorker = require(_dependencyMap[1], \"./ZipFileWorker\");\n\n  /**\n   * Find the compression to use.\n   * @param {String} fileCompression the compression defined at the file level, if any.\n   * @param {String} zipCompression the compression defined at the load() level.\n   * @return {Object} the compression object to use.\n   */\n  var getCompression = function (fileCompression, zipCompression) {\n    var compressionName = fileCompression || zipCompression;\n    var compression = compressions[compressionName];\n    if (!compression) {\n      throw new Error(compressionName + \" is not a valid compression method !\");\n    }\n    return compression;\n  };\n\n  /**\n   * Create a worker to generate a zip file.\n   * @param {JSZip} zip the JSZip instance at the right root level.\n   * @param {Object} options to generate the zip file.\n   * @param {String} comment the comment to use.\n   */\n  exports.generateWorker = function (zip, options, comment) {\n    var zipFileWorker = new ZipFileWorker(options.streamFiles, comment, options.platform, options.encodeFileName);\n    var entriesCount = 0;\n    try {\n      zip.forEach(function (relativePath, file) {\n        entriesCount++;\n        var compression = getCompression(file.options.compression, options.compression);\n        var compressionOptions = file.options.compressionOptions || options.compressionOptions || {};\n        var dir = file.dir,\n          date = file.date;\n        file._compressWorker(compression, compressionOptions).withStreamInfo(\"file\", {\n          name: relativePath,\n          dir: dir,\n          date: date,\n          comment: file.comment || \"\",\n          unixPermissions: file.unixPermissions,\n          dosPermissions: file.dosPermissions\n        }).pipe(zipFileWorker);\n      });\n      zipFileWorker.entriesCount = entriesCount;\n    } catch (e) {\n      zipFileWorker.error(e);\n    }\n    return zipFileWorker;\n  };\n});","lineCount":53,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0],[4,6,3,4,"compressions"],[4,18,3,16],[4,21,3,19,"require"],[4,28,3,26],[4,29,3,26,"_dependencyMap"],[4,43,3,26],[4,65,3,44],[4,66,3,45],[5,2,4,0],[5,6,4,4,"ZipFileWorker"],[5,19,4,17],[5,22,4,20,"require"],[5,29,4,27],[5,30,4,27,"_dependencyMap"],[5,44,4,27],[5,66,4,45],[5,67,4,46],[7,2,6,0],[8,0,7,0],[9,0,8,0],[10,0,9,0],[11,0,10,0],[12,0,11,0],[13,2,12,0],[13,6,12,4,"getCompression"],[13,20,12,18],[13,23,12,21],[13,32,12,21,"getCompression"],[13,33,12,31,"fileCompression"],[13,48,12,46],[13,50,12,48,"zipCompression"],[13,64,12,62],[13,66,12,64],[14,4,14,4],[14,8,14,8,"compressionName"],[14,23,14,23],[14,26,14,26,"fileCompression"],[14,41,14,41],[14,45,14,45,"zipCompression"],[14,59,14,59],[15,4,15,4],[15,8,15,8,"compression"],[15,19,15,19],[15,22,15,22,"compressions"],[15,34,15,34],[15,35,15,35,"compressionName"],[15,50,15,50],[15,51,15,51],[16,4,16,4],[16,8,16,8],[16,9,16,9,"compression"],[16,20,16,20],[16,22,16,22],[17,6,17,8],[17,12,17,14],[17,16,17,18,"Error"],[17,21,17,23],[17,22,17,24,"compressionName"],[17,37,17,39],[17,40,17,42],[17,78,17,80],[17,79,17,81],[18,4,18,4],[19,4,19,4],[19,11,19,11,"compression"],[19,22,19,22],[20,2,20,0],[20,3,20,1],[22,2,22,0],[23,0,23,0],[24,0,24,0],[25,0,25,0],[26,0,26,0],[27,0,27,0],[28,2,28,0,"exports"],[28,9,28,7],[28,10,28,8,"generateWorker"],[28,24,28,22],[28,27,28,25],[28,37,28,35,"zip"],[28,40,28,38],[28,42,28,40,"options"],[28,49,28,47],[28,51,28,49,"comment"],[28,58,28,56],[28,60,28,58],[29,4,30,4],[29,8,30,8,"zipFileWorker"],[29,21,30,21],[29,24,30,24],[29,28,30,28,"ZipFileWorker"],[29,41,30,41],[29,42,30,42,"options"],[29,49,30,49],[29,50,30,50,"streamFiles"],[29,61,30,61],[29,63,30,63,"comment"],[29,70,30,70],[29,72,30,72,"options"],[29,79,30,79],[29,80,30,80,"platform"],[29,88,30,88],[29,90,30,90,"options"],[29,97,30,97],[29,98,30,98,"encodeFileName"],[29,112,30,112],[29,113,30,113],[30,4,31,4],[30,8,31,8,"entriesCount"],[30,20,31,20],[30,23,31,23],[30,24,31,24],[31,4,32,4],[31,8,32,8],[32,6,34,8,"zip"],[32,9,34,11],[32,10,34,12,"forEach"],[32,17,34,19],[32,18,34,20],[32,28,34,30,"relativePath"],[32,40,34,42],[32,42,34,44,"file"],[32,46,34,48],[32,48,34,50],[33,8,35,12,"entriesCount"],[33,20,35,24],[33,22,35,26],[34,8,36,12],[34,12,36,16,"compression"],[34,23,36,27],[34,26,36,30,"getCompression"],[34,40,36,44],[34,41,36,45,"file"],[34,45,36,49],[34,46,36,50,"options"],[34,53,36,57],[34,54,36,58,"compression"],[34,65,36,69],[34,67,36,71,"options"],[34,74,36,78],[34,75,36,79,"compression"],[34,86,36,90],[34,87,36,91],[35,8,37,12],[35,12,37,16,"compressionOptions"],[35,30,37,34],[35,33,37,37,"file"],[35,37,37,41],[35,38,37,42,"options"],[35,45,37,49],[35,46,37,50,"compressionOptions"],[35,64,37,68],[35,68,37,72,"options"],[35,75,37,79],[35,76,37,80,"compressionOptions"],[35,94,37,98],[35,98,37,102],[35,99,37,103],[35,100,37,104],[36,8,38,12],[36,12,38,16,"dir"],[36,15,38,19],[36,18,38,22,"file"],[36,22,38,26],[36,23,38,27,"dir"],[36,26,38,30],[37,10,38,32,"date"],[37,14,38,36],[37,17,38,39,"file"],[37,21,38,43],[37,22,38,44,"date"],[37,26,38,48],[38,8,40,12,"file"],[38,12,40,16],[38,13,40,17,"_compressWorker"],[38,28,40,32],[38,29,40,33,"compression"],[38,40,40,44],[38,42,40,46,"compressionOptions"],[38,60,40,64],[38,61,40,65],[38,62,41,17,"withStreamInfo"],[38,76,41,31],[38,77,41,32],[38,83,41,38],[38,85,41,40],[39,10,42,20,"name"],[39,14,42,24],[39,16,42,27,"relativePath"],[39,28,42,39],[40,10,43,20,"dir"],[40,13,43,23],[40,15,43,26,"dir"],[40,18,43,29],[41,10,44,20,"date"],[41,14,44,24],[41,16,44,27,"date"],[41,20,44,31],[42,10,45,20,"comment"],[42,17,45,27],[42,19,45,30,"file"],[42,23,45,34],[42,24,45,35,"comment"],[42,31,45,42],[42,35,45,46],[42,37,45,48],[43,10,46,20,"unixPermissions"],[43,25,46,35],[43,27,46,38,"file"],[43,31,46,42],[43,32,46,43,"unixPermissions"],[43,47,46,58],[44,10,47,20,"dosPermissions"],[44,24,47,34],[44,26,47,37,"file"],[44,30,47,41],[44,31,47,42,"dosPermissions"],[45,8,48,16],[45,9,48,17],[45,10,48,18],[45,11,49,17,"pipe"],[45,15,49,21],[45,16,49,22,"zipFileWorker"],[45,29,49,35],[45,30,49,36],[46,6,50,8],[46,7,50,9],[46,8,50,10],[47,6,51,8,"zipFileWorker"],[47,19,51,21],[47,20,51,22,"entriesCount"],[47,32,51,34],[47,35,51,37,"entriesCount"],[47,47,51,49],[48,4,52,4],[48,5,52,5],[48,6,52,6],[48,13,52,13,"e"],[48,14,52,14],[48,16,52,16],[49,6,53,8,"zipFileWorker"],[49,19,53,21],[49,20,53,22,"error"],[49,25,53,27],[49,26,53,28,"e"],[49,27,53,29],[49,28,53,30],[50,4,54,4],[51,4,56,4],[51,11,56,11,"zipFileWorker"],[51,24,56,24],[52,2,57,0],[52,3,57,1],[53,0,57,2],[53,3]],"functionMap":{"names":["<global>","getCompression","exports.generateWorker","zip.forEach$argument_0"],"mappings":"AAA;qBCW;CDQ;yBEQ;oBCM;SDgB;CFO"},"hasCjsExports":true},"type":"js/module"}]}